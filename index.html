<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #fafafa;
      color: #1a1a1a;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px 16px 80px;
      line-height: 1.5;
    }

    /* SPLASH */
    #splash {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 999999;
      opacity: 1;
      transition: opacity 0.6s ease;
    }
    .splash-logo {
      width: 100px;
      height: 100px;
      object-fit: cover;
      margin-bottom: 24px;
      animation: bounce 1.4s infinite ease-in-out;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    .splash-text {
      color: #888;
      font-size: 16px;
      font-weight: 500;
      text-align: center;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –º–æ–ª–æ—Ç–∫–∞ –Ω–∞ splash */
    .hammer-anim {
      display: inline-block;
      animation: hammerTap 1.4s infinite ease-in-out;
    }
    @keyframes hammerTap {
      0%, 100% {
        transform: translateY(0) rotate(0);
      }
      30% {
        transform: translateY(6px) rotate(5deg);
      }
      50% {
        transform: translateY(0) rotate(0);
      }
    }

    .page {
      display: none;
      opacity: 0;
      transform: translateY(20px);
      animation: pageEnter 0.8s forwards cubic-bezier(0.22, 0.61, 0.36, 1);
    }
    .active {
      display: block;
    }
    @keyframes pageEnter {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card {
      background: #ffffff;
      padding: 18px;
      border-radius: 16px;
      margin: 16px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .search-box input {
      width: 100%;
      padding: 14px 16px;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      font-size: 16px;
      font-family: inherit;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .search-box input:focus {
      outline: none;
      border-color: #4CAF50;
      box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
    }

    /* –°–õ–ê–ô–î–ï–† */
    .banner {
      text-align: center;
      margin: 28px 0;
      position: relative;
    }
    .banner-slides {
      display: flex;
      width: 200%;
      height: 140px;
      overflow: hidden;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: transform 0.8s cubic-bezier(0.22, 0.61, 0.36, 1);
      will-change: transform;
    }
    .banner-slide {
      width: 50%;
      height: 100%;
      flex-shrink: 0;
      position: relative;
    }
    .banner-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      image-rendering: -webkit-optimize-contrast;
    }
    .banner-text {
      margin-top: 12px;
      font-weight: 700;
      color: #e74c3c;
      font-size: 17px;
      letter-spacing: -0.2px;
    }

    .banner-dots {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 14px;
    }
    .banner-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #d0d0d0;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .banner-dot.active {
      background: #4CAF50;
      transform: scale(1.2);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 24px 0 16px;
    }
    .section-title {
      font-size: 19px;
      font-weight: 700;
      color: #222;
    }

    .view-all-btn,
    .btn,
    .btn-remove {
      border: none;
      border-radius: 12px;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.25s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .view-all-btn {
      background: linear-gradient(135deg, #4CAF50, #2E7D32);
      color: white;
      padding: 8px 16px;
      font-size: 14px;
      box-shadow: 0 2px 6px rgba(76, 175, 80, 0.3);
    }
    .view-all-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(76, 175, 80, 0.4);
    }

    .btn {
      background: linear-gradient(135deg, #2196F3, #1976D2);
      color: white;
      padding: 10px 16px;
      font-size: 14px;
      box-shadow: 0 2px 6px rgba(33, 150, 243, 0.3);
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(33, 150, 243, 0.4);
    }

    .btn-remove {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
      padding: 8px 14px;
      font-size: 13px;
      box-shadow: 0 2px 6px rgba(244, 67, 54, 0.3);
    }
    .btn-remove:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(244, 67, 54, 0.4);
    }

    .offers-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
    }
    .offer-card {
      background: #fff;
      border-radius: 14px;
      overflow: hidden;
      text-align: center;
      font-size: 13px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
      position: relative;
      transition: transform 0.2s;
    }
    .offer-card:hover {
      transform: translateY(-3px);
    }
    .offer-card img {
      width: 100%;
      height: 90px;
      object-fit: cover;
      display: block;
    }

    .favorite-toggle {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    .favorite-toggle svg {
      fill: transparent;
      stroke: #e74c3c;
      stroke-width: 2;
      transition: all 0.25s ease;
    }
    .favorite-toggle.active svg {
      fill: #e74c3c;
      stroke: #e74c3c;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-around;
      background: white;
      border-top: 1px solid #eee;
      padding: 14px 0;
      box-shadow: 0 -2px 12px rgba(0,0,0,0.06);
    }
    .nav-btn {
      background: none;
      border: none;
      color: #777;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      transition: color 0.2s;
    }
    .nav-btn.active {
      color: #4CAF50;
    }
    .nav-icon {
      font-size: 22px;
    }

    .property {
      display: flex;
      gap: 14px;
      margin: 14px 0;
      align-items: flex-start;
      position: relative;
    }
    .property img {
      width: 84px;
      height: 84px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.08);
    }
    .property-info {
      flex: 1;
    }
    .property-info strong {
      font-weight: 600;
      color: #222;
    }
    .property-info span {
      color: #e74c3c;
      font-weight: 600;
    }
  </style>
</head>
<body>

<!-- SPLASH ‚Äî —Å –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–æ–ª–æ—Ç–∫–æ–º -->
<div id="splash">
  <img src="https://i.ibb.co/xKZ1hC1j/Dt-L73-Ny-XFi8-Gj0c-Np5-Zr-ZQni2c-QXIXMubb9j-U-kj-Io-Z9q-Nj-ukw-RQ3f4-Bb-Bp-CWLox-B4pm-Fso-Gh-Hz-Go-Xqb.jpg" class="splash-logo" alt="–õ–æ–≥–æ—Ç–∏–ø">
  <div class="splash-text">–£–∂–µ —Å—Ç—Ä–æ–∏–º <span class="hammer-anim">üî®</span></div>
</div>

<!-- –ì–õ–ê–í–ù–ê–Ø -->
<div id="home" class="page">
  <div class="search-box">
    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º...">
  </div>

  <div class="banner">
    <div class="banner-slides" id="bannerSlides"></div>
    <div class="banner-dots" id="bannerDots"></div>
    <div class="banner-text">üî• –¢–æ–ª—å–∫–æ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π ‚Äî –æ—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è!</div>
  </div>

  <div class="section-header">
    <div class="section-title">üî• Hot offers</div>
    <button class="view-all-btn" onclick="show('catalog')">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å—ë</button>
  </div>
  <div class="offers-grid" id="hotOffers"></div>

  <div class="section-header">
    <div class="section-title">üèÜ –•–∏—Ç—ã –ø—Ä–æ–¥–∞–∂</div>
    <button class="view-all-btn" onclick="show('catalog')">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å—ë</button>
  </div>
  <div class="offers-grid" id="hitOffers"></div>
</div>

<div id="catalog" class="page"><div id="catalog-list"></div></div>
<div id="favorites" class="page">
  <div class="card">
    <h3 style="font-weight:700;margin-bottom:12px;">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h3>
    <div id="fav-list">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤</div>
  </div>
</div>
<div id="profile" class="page">
  <div class="card" style="text-align: center; padding: 26px;">
    <img id="user-photo" src="https://upload.wikimedia.org/wikipedia/commons/8/89/Portrait_Placeholder.png"
         alt="–ê–≤–∞—Ç–∞—Ä" style="width: 88px; height: 88px; border-radius: 50%; margin-bottom: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
    <div id="user-info">–£–∂–µ —Å—Ç—Ä–æ–∏–º...</div>
  </div>
  <div class="card">
    <h3 style="font-weight:700;margin-bottom:12px;">–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</h3>
    <div id="history-list">–ù–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div>
  </div>
</div>

<div class="bottom-nav">
  <button class="nav-btn" onclick="show('home')">
    <div class="nav-icon">üè†</div><span>–ì–ª–∞–≤–Ω–∞—è</span>
  </button>
  <button class="nav-btn" onclick="show('catalog')">
    <div class="nav-icon">üèòÔ∏è</div><span>–ö–∞—Ç–∞–ª–æ–≥</span>
  </button>
  <button class="nav-btn" onclick="show('favorites')">
    <div class="nav-icon">‚ù§Ô∏è</div><span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
  </button>
  <button class="nav-btn" onclick="show('profile')">
    <div class="nav-icon">üë§</div><span>–ü—Ä–æ—Ñ–∏–ª—å</span>
  </button>
</div>

<script>
  const ALL_ADS = [
    { id: 1, title: "2-–∫–æ–º–Ω. –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ", price: "9 500 000 ‚ÇΩ" },
    { id: 2, title: "–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞ —É –º–µ—Ç—Ä–æ", price: "12 300 000 ‚ÇΩ" },
    { id: 3, title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞ —Å —Ä–µ–º–æ–Ω—Ç–æ–º", price: "8 200 000 ‚ÇΩ" },
    { id: 4, title: "–ü—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è 3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è", price: "15 000 000 ‚ÇΩ" },
    { id: 5, title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞-—Å—Ç—É–¥–∏—è", price: "5 900 000 ‚ÇΩ" },
    { id: 6, title: "–≠–ª–∏—Ç–Ω—ã–π –ø–µ–Ω—Ç—Ö–∞—É—Å", price: "45 000 000 ‚ÇΩ" }
  ];

  const BANNER_IMAGES = [
    "https://i.ibb.co/rSvtVFY/j63jvsdndcc71zqold2r6jhwg9czqdx9.jpg",
    "https://i.ibb.co/PkZNfb5/i.webp"
  ];

  const AD_IMAGE = "https://i.ibb.co/ds3qdSRp/ass-AZpmsu-Aq-Kp9-Gl-YLg-Uy-O-nb-Um3-Frkf-Xa-TQpl-Fam-Ka-Btc9-CGPqwj-Gh-Utve0f-Haje6lr-Bk0-GDJL6-Zu-Fg3uy.jpg";

  let favorites = JSON.parse(localStorage.getItem('fav') || '[]');
  let history = JSON.parse(localStorage.getItem('history') || '[]');
  let currentSlide = 0;
  let slideInterval;

  function updateHomeFavorites() {
    document.querySelectorAll('.offer-card').forEach(card => {
      const id = parseInt(card.dataset.id);
      const toggle = card.querySelector('.favorite-toggle');
      if (toggle) {
        if (favorites.includes(id)) {
          toggle.classList.add('active');
        } else {
          toggle.classList.remove('active');
        }
      }
    });
  }

  function initBannerSlider() {
    const slidesContainer = document.getElementById('bannerSlides');
    const dotsContainer = document.getElementById('bannerDots');

    slidesContainer.innerHTML = BANNER_IMAGES.map((src, index) => `
      <div class="banner-slide">
        <img
          src="${src}"
          alt="–ë–∞–Ω–Ω–µ—Ä ${index + 1}"
          loading="lazy"
          decoding="async"
          onerror="this.parentElement.style.backgroundColor='#f0f0f0'; this.style.display='none';"
        >
      </div>
    `).join('');

    dotsContainer.innerHTML = BANNER_IMAGES.map((_, i) => `
      <div class="banner-dot" data-index="${i}"></div>
    `).join('');

    updateBanner();

    dotsContainer.querySelectorAll('.banner-dot').forEach(dot => {
      dot.addEventListener('click', () => {
        currentSlide = parseInt(dot.getAttribute('data-index'));
        updateBanner();
        resetInterval();
      });
    });

    startAutoSlide();
  }

  function updateBanner() {
    const slidesContainer = document.getElementById('bannerSlides');
    const dots = document.querySelectorAll('.banner-dot');

    const offset = -currentSlide * 50;
    slidesContainer.style.transform = `translateX(${offset}%)`;

    dots.forEach((dot, i) => {
      dot.classList.toggle('active', i === currentSlide);
    });
  }

  function nextSlide() {
    currentSlide = (currentSlide + 1) % BANNER_IMAGES.length;
    updateBanner();
  }

  function startAutoSlide() {
    clearInterval(slideInterval);
    slideInterval = setInterval(nextSlide, 3500);
  }

  function resetInterval() {
    clearInterval(slideInterval);
    startAutoSlide();
  }

  function renderHomePreviews() {
    const hotEl = document.getElementById('hotOffers');
    const hitEl = document.getElementById('hitOffers');
    const hot = ALL_ADS.slice(0, 2);
    const hit = ALL_ADS.slice(2, 4);

    const card = (ad) => {
      const isFav = favorites.includes(ad.id);
      return `
        <div class="offer-card" data-id="${ad.id}">
          <img src="${AD_IMAGE}" alt="${ad.title}" loading="lazy" decoding="async">
          <div style="padding:8px 6px;font-weight:600;font-size:13px;">${ad.title}</div>
          <div style="color:#e74c3c;font-weight:600;padding:0 6px 8px;">${ad.price}</div>
          <div class="favorite-toggle ${isFav ? 'active' : ''}" onclick="toggleFavorite(${ad.id}, this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
          </div>
        </div>
      `;
    };

    hotEl.innerHTML = hot.map(card).join('');
    hitEl.innerHTML = hit.map(card).join('');
  }

  function renderCatalog() {
    const list = document.getElementById('catalog-list');
    list.innerHTML = ALL_ADS.map(ad => {
      const isFav = favorites.includes(ad.id);
      return `
        <div class="property">
          <img src="${AD_IMAGE}" alt="${ad.title}" loading="lazy" decoding="async">
          <div class="property-info">
            <strong>${ad.title}</strong><br>
            <span>${ad.price}</span><br>
            <button class="btn" onclick="view(${ad.id})" style="background:linear-gradient(135deg, #5ac8fa, #007aff);box-shadow:0 2px 6px rgba(90,200,250,0.3);">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å</button>
          </div>
          <div class="favorite-toggle ${isFav ? 'active' : ''}" onclick="toggleFavorite(${ad.id}, this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
          </div>
        </div>
      `;
    }).join('');
  }

  function renderFavorites() {
    const list = document.getElementById('fav-list');
    const items = favorites.map(id => ALL_ADS.find(ad => ad.id === id)).filter(Boolean);
    if (items.length === 0) {
      list.textContent = '–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤';
      return;
    }
    list.innerHTML = items.map(item => `
      <div class="property">
        <img src="${AD_IMAGE}" alt="" loading="lazy" decoding="async">
        <div class="property-info">
          <strong>${item.title}</strong><br>
          <span>${item.price}</span><br>
          <button class="btn-remove" onclick="removeFromFavorites(${item.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
        </div>
      </div>
    `).join('');
  }

  function renderHistory() {
    const list = document.getElementById('history-list');
    const items = history.map(id => ALL_ADS.find(ad => ad.id === id)).filter(Boolean);
    if (items.length === 0) {
      list.textContent = '–ù–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤';
      return;
    }
    list.innerHTML = items.map(item => `
      <div class="property">
        <img src="${AD_IMAGE}" alt="" loading="lazy" decoding="async">
        <div class="property-info">
          <strong>${item.title}</strong><br>
          <span>${item.price}</span>
        </div>
      </div>
    `).join('');
  }

  function toggleFavorite(id, el) {
    const index = favorites.indexOf(id);
    if (index === -1) {
      favorites.push(id);
      el.classList.add('active');
    } else {
      favorites.splice(index, 1);
      el.classList.remove('active');
    }
    localStorage.setItem('fav', JSON.stringify(favorites));
    if (document.getElementById('favorites').classList.contains('active')) {
      renderFavorites();
    }
    updateHomeFavorites();
  }

  function removeFromFavorites(id) {
    favorites = favorites.filter(i => i !== id);
    localStorage.setItem('fav', JSON.stringify(favorites));
    renderFavorites();
    updateHomeFavorites();
  }

  function view(id) {
    if (!history.includes(id)) {
      history.unshift(id);
      if (history.length > 10) history.pop();
      localStorage.setItem('history', JSON.stringify(history));
      renderHistory();
    }
    alert('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏—Å—Ç–æ—Ä–∏—é');
  }

  function show(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');

    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    const buttons = document.querySelectorAll('.nav-btn');
    for (let btn of buttons) {
      if (btn.getAttribute('onclick')?.includes(`show('${pageId}')`)) {
        btn.classList.add('active');
        break;
      }
    }

    if (pageId === 'favorites') renderFavorites();
    if (pageId === 'profile') renderHistory();
  }

  function initTelegram() {
    try {
      const WebApp = window.Telegram.WebApp;
      WebApp.expand();
      WebApp.ready();
      const user = WebApp.initDataUnsafe?.user;
      if (user) {
        document.getElementById('user-info').innerHTML = `
          <strong>${user.first_name || ''} ${user.last_name || ''}</strong><br>
          <span style="color:#555;">@${user.username || '‚Äî'}</span><br>
          <span style="color:#888;font-size:13px;">ID: ${user.id}</span>
        `;
        if (user.photo_url) {
          document.getElementById('user-photo').src = user.photo_url;
        }
      } else {
        document.getElementById('user-info').textContent = '–ù–µ –∑–∞–ø—É—â–µ–Ω–æ –∏–∑ Telegram';
      }
    } catch (e) {
      document.getElementById('user-info').textContent = '–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏';
    }
  }

  function startApp() {
    initTelegram();
    renderHomePreviews();
    renderCatalog();
    initBannerSlider();

    setTimeout(() => {
      const splash = document.getElementById('splash');
      if (splash) {
        splash.style.opacity = '0';
        setTimeout(() => splash.remove(), 600);
      }
      show('home');
    }, 2000);
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', startApp);
  } else {
    startApp();
  }

  document.getElementById('searchInput')?.addEventListener('focus', () => {
    show('catalog');
  });
</script>
</body>
</html>